<!DOCTYPE html>
<html>


  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Taxi4Paris</title>
    <script src="http://maps.googleapis.com/maps/api/js"></script>
    <link rel="stylesheet" href="style.css" type="text/css" media="screen" />
    <script type="text/javascript" src="lib/jquery.js"></script>
  </head>
  <body>

  <script src="./node_modules/socket.io-client/socket.io.js"></script>
  <script type="text/javascript" src="main.js"></script>
  <script>
    var socket = io.connect('http://localhost:8000');

    function listeners(index)
    {
      return function()
      {
        map.setCenter(markers[index].getPosition());
        map.setZoom(16);
        $('#navbar p').empty();
        $('#navbar p').text('Taxi '+index+' successfully ordered');
        taxi_move(index, function() {
          $('#navbar p').html('<strong>Taxi '+index+' have arrived.</strong>');
          $('#navbar').animate({top: '90%'}, 3000, function() { $('#navbar').css('top', '0%');});
         });
      };
    }

    socket.on('news', function (data) {
      markers = [];

    for (i = 0; i < data.length; i++)
    {
      markers[parseInt(data[i].id)] = new google.maps.Marker({
        position: new google.maps.LatLng(data[i].lat, data[i].lon),
        icon: 'car.png'
      });
      markers[parseInt(data[i].id)].setMap(map);
      markers[parseInt(data[i].id)].addListener('click', listeners(parseInt(data[i].id)));
    }
    });

    socket.on('refresh_taxis', function (data) {

    });
  </script>

  <script>
    /*$(document).ready(appelWeather);*/
  </script>

  <div id="googleMap"></div>

  <div id="navbar">
  <p>
    To order a taxi, please click on the nearest regarding your location.
  </p>
  </div>

  </body>
  </html>
